---
name: Events
route: /events
---


# Events

Interfaces are created using `setup` which is included when generating the
interface from the console.

```javascript
myUI = setup(window, document, "script", "sajari");
```

You can subscribe to events by calling your interface with the `"sub"` value
followed by the pipeline (either `pipeline` or `instantPipeline`) and event
name, then a callback. It takes the form

```javascript
myUI("sub", "<pipeline>.<event>", callback);
```

For example, if you are using the default inline interface and want to listen to
the `search-sent` event, you'd write:

```javascript
myUI("sub", "pipeline.search-sent", function(event, values) {
  console.log("Search sent with values: ", values);
});
```

| Event                |       Data       | Description                                          |
| :------------------- | :--------------: | :--------------------------------------------------- |
| `"search-sent"`      | value dictionary | Search request has been sent                         |
| `"values-updated"`   | value dictionary | Value map has updated                                |
| `"response-updated"` | response object  | Response has updated                                 |
| `"page-closed"`      |   query string   | Page is about to be closed                           |
| `"query-reset"`      |   query string   | Body has changed enough to be considered a new query |
| `"result-clicked"`   |   query string   | Result has been clicked                              |
| `"search-event"`     |   query string   | Search event                                         |
| `"overlay-show"`     |       none       | Overlay is shown                                     |
| `"overlay-hide"`     |       none       | Overlay is hidden                                    |

You can also publish events which the search interface will pick up.

| Event            |       Data       | Description        |
| :--------------- | :--------------: | :----------------- |
| `"values-set"`   | value dictionary | Values to merge in |
| `"search-send"`  |       none       | Perform a search   |
| `"overlay-show"` |       none       | Show the overlay   |
| `"overlay-hide"` |       none       | Hide the overlay   |

#### Search Sent

A search has sent and we are now waiting for results. The values used in the
search are given to the subscribed function.

```javascript
myUI("sub", "<pipeline>.search-sent", function(eventName, values) {
  console.log("Search sent with ", values);
});
```

#### Values Updated

Values in the interface have been updated. A function is given as the 3rd
argument that can be used to merge new values into the value dictionary, it
behaves like `pub("values-set", {})` except that it doesn't trigger an event.

```javascript
myUI("sub", "<pipeline>.values-updated", function(eventName, values, set) {
  console.log("New values are", values);
});
```

#### Response Updated

The search response has been updated. Caused by a network response being
received or results being cleared (usually because the input box has become
empty).

You can see more info about the `response` object
[here](https://github.com/sajari/sajari-sdk-react#listening-for-responses).

```javascript
myUI("sub", "<pipeline>.response-updated", function(eventName, response) {
  if (response.isEmpty()) {
    return;
  }
  if (response.isError()) {
    console.log("Got error", response.getError());
  } else {
    console.log("Got results", response.getResults());
  }
});
```

#### Search Event

A search event signals the end of a search session. A common use case of
subscribing to them is for reporting.

```javascript
myUI("sub", "<pipeline>.search-event", function(eventName, query) {
  console.log("Search session finished, last query", query);
});
```

If you'd like more granular events you can also subscribe to these events.

```javascript
function searchFinished(eventName, query) {
  console.log("Search session finished, last query", query);
}
myUI("sub", "<pipeline>.page-closed", searchFinished);
myUI("sub", "<pipeline>.query-reset", searchFinished);
myUI("sub", "<pipeline>.result-clicked", searchFinished);
```

#### Overlay Show/Hide

Opening and closing the overlay can be done by publishing either the show or
hide event.

**Note: The show and hide events do not have a pipeline prefixing the event
name!**

```javascript
myUI("pub", "overlay-show");
myUI("pub", "overlay-hide");
```

You can also subscribe to these events

```javascript
myUI("sub", "overlay-show", function(eventName) {
  console.log("The overlay has been shown");
});
myUI("sub", "overlay-hide", function(eventName) {
  console.log("The overlay has been hidden");
});
```

#### Set Values

Merge new values into the values dictionary. Setting a value to undefined will
remove it from the values dictionary.

```javascript
myUI("pub", "<pipeline>.values-set", { q: "<search query>" });
```

#### Search

Search will perform a search request using the values in the value map.

```javascript
myUI("pub", "<pipeline>.search-send");
```